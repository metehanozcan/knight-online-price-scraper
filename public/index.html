<!DOCTYPE html>
<html lang="tr" class="scroll-smooth transition-all duration-300">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Knight Online GB Fiyat Takipçisi</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="output.css" rel="stylesheet">
</head>
<body class="bg-gray-50 dark:bg-slate-900 text-gray-900 dark:text-gray-100 transition-all duration-300">
    <!-- Header -->
    <header class="sticky top-0 z-50 backdrop-blur-md bg-white/80 dark:bg-slate-900/80 border-b border-gray-200 dark:border-slate-700">
        <div class="max-w-7xl mx-auto px-4 py-3 sm:px-6 lg:px-8 sm:py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3 sm:space-x-4">
                    <!-- Gold Bar Logo -->
                    <div class="gold-bar-3d w-10 h-6 sm:w-12 sm:h-8 flex items-center justify-center animate-pulse-gold">
                        <span class="text-white font-bold text-xs">GB</span>
                    </div>
                    <div>
                        <h1 class="text-lg sm:text-2xl font-bold bg-gradient-to-r from-gold to-gold-dark bg-clip-text text-transparent">
                            Knight Online GB Takipçisi
                        </h1>
                        <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-400">Gerçek zamanlı fiyat karşılaştırması</p>
                    </div>
                </div>

                <!-- Theme Toggle -->
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <div class="hidden sm:flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        <span>Canlı takip</span>
                    </div>
                    <button id="theme-toggle" class="p-2 rounded-lg bg-gray-100 dark:bg-slate-800 hover:bg-gray-200 dark:hover:bg-slate-700 transition-all duration-200 group min-h-[44px] min-w-[44px] flex items-center justify-center">
                        <svg id="sun-icon" class="w-5 h-5 text-yellow-500 dark:hidden group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"/>
                        </svg>
                        <svg id="moon-icon" class="w-5 h-5 text-slate-400 hidden dark:block group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8 sm:py-8">
        <!-- Quick Server Selection -->
        <div class="glass-effect rounded-2xl p-4 sm:p-6 mb-6 sm:mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6">
                <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 flex items-center mb-2 sm:mb-0">
                    <svg class="w-5 h-5 mr-2 text-gold" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Hızlı Sunucu Seçimi
                </h3>
                <div class="text-sm text-gray-600 dark:text-gray-400">
                    Sunucunuzu seçin ve anında sonuçları görün
                </div>
            </div>

            <!-- Server Buttons -->
            <div class="grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-3 mb-4">
                <button id="server-btn-all" class="server-btn server-btn-active px-3 py-3 sm:px-6 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900 col-span-2 sm:col-span-1">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <span class="hidden sm:inline">Tüm Sunucular</span>
                    <span class="sm:hidden">Tümü</span>
                </button>

                <button id="server-btn-ZERO" class="server-btn bg-red-500 hover:bg-red-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="ZERO">
                    Zero
                </button>

                <button id="server-btn-FELIS" class="server-btn bg-orange-500 hover:bg-orange-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="FELIS">
                    Felis
                </button>

                <button id="server-btn-PANDORA" class="server-btn bg-purple-500 hover:bg-purple-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="PANDORA">
                    Pandora
                </button>

                <button id="server-btn-AGARTHA" class="server-btn bg-blue-500 hover:bg-blue-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="AGARTHA">
                    Agartha
                </button>

                <button id="server-btn-DRYADS" class="server-btn bg-green-500 hover:bg-green-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="DRYADS">
                    Dryads
                </button>

                <button id="server-btn-DESTAN" class="server-btn bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="DESTAN">
                    Destan
                </button>

                <button id="server-btn-MINARK" class="server-btn bg-pink-500 hover:bg-pink-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="MINARK">
                    Minark
                </button>

                <button id="server-btn-OREADS" class="server-btn bg-indigo-500 hover:bg-indigo-600 text-white px-3 py-3 sm:px-5 rounded-xl font-semibold text-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900" data-server="OREADS">
                    Oreads
                </button>
            </div>

            <!-- Active Filter Info -->
            <div id="filter-info" class="text-sm text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-slate-800 rounded-lg px-4 py-2">
                <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                </svg>
                <span id="filter-text">Tüm sunucular gösteriliyor</span>
            </div>
        </div>

        <!-- Best Deal Cards -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8">
            <!-- Best Buy Price Card -->
            <div id="best-buy-card" class="glass-effect rounded-2xl p-6 sm:p-8 text-center animate-fade-in relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-500 to-emerald-600"></div>
                <div class="inline-flex items-center px-4 py-2 rounded-full bg-green-500/20 text-green-600 dark:text-green-400 text-sm font-semibold mb-4 sm:mb-6">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M7 18c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                    </svg>
                    En Ucuz Alış
                </div>
                <div class="space-y-4">
                    <div>
                        <div class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">En Ucuz Alış Fiyatı</div>
                        <div id="best-buy-price-display" class="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent animate-bounce-subtle">
                            Yükleniyor...
                        </div>
                    </div>
                    <div id="best-buy-site-display" class="p-4 rounded-xl bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-800">
                        <div class="flex items-center justify-center space-x-3">
                            <div id="best-buy-site-icon" class="w-10 h-10 rounded-xl bg-green-500 text-white flex items-center justify-center font-bold text-lg">
                                ?
                            </div>
                            <div class="text-left">
                                <div id="best-buy-site-name" class="text-lg font-bold text-green-700 dark:text-green-300">
                                    Veriler getiriliyor...
                                </div>
                                <div id="best-buy-server-name" class="text-sm text-green-600 dark:text-green-400">
                                    --
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Best Sell Price Card -->
            <div id="best-sell-card" class="glass-effect rounded-2xl p-6 sm:p-8 text-center animate-fade-in relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-cyan-600"></div>
                <div class="inline-flex items-center px-4 py-2 rounded-full bg-blue-500/20 text-blue-600 dark:text-blue-400 text-sm font-semibold mb-4 sm:mb-6">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
                    </svg>
                    En Yüksek Satış
                </div>
                <div class="space-y-4">
                    <div>
                        <div class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">En Yüksek Satış Fiyatı</div>
                        <div id="best-sell-price-display" class="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent animate-bounce-subtle">
                            Yükleniyor...

                        </div>
                    </div>
                    <div id="best-sell-site-display" class="p-4 rounded-xl bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 border border-blue-200 dark:border-blue-800">
                        <div class="flex items-center justify-center space-x-3">
                            <div id="best-sell-site-icon" class="w-10 h-10 rounded-xl bg-blue-500 text-white flex items-center justify-center font-bold text-lg">
                                ?
                            </div>
                            <div class="text-left">
                                <div id="best-sell-site-name" class="text-lg font-bold text-blue-700 dark:text-blue-300">
                                    Veriler getiriliyor...
                                </div>
                                <div id="best-sell-server-name" class="text-sm text-blue-600 dark:text-blue-400">
                                    --
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Filters Section -->
        <div class="filters-mobile grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
            <!-- Server Filter (Hidden, controlled by buttons) -->
            <div class="glass-effect rounded-xl p-4 sm:p-6">
                <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Gelişmiş Sunucu Filtresi
                </label>
                <select id="server-filter" class="custom-select w-full px-4 py-3 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-gold focus:border-transparent transition-all duration-200">
                    <option value="">Tüm Sunucular</option>
                    <option value="ZERO">Zero</option>
                    <option value="FELIS">Felis</option>
                    <option value="PANDORA">Pandora</option>
                    <option value="AGARTHA">Agartha</option>
                    <option value="DRYADS">Dryads</option>
                    <option value="DESTAN">Destan</option>
                    <option value="MINARK">Minark</option>
                    <option value="OREADS">Oreads</option>
                </select>
            </div>

            <!-- Site Filter -->
            <div class="glass-effect rounded-xl p-4 sm:p-6">
                <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                    Site Filtresi
                </label>
                <select id="site-filter" class="custom-select w-full px-4 py-3 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-gold focus:border-transparent transition-all duration-200">
                    <option value="">Tüm Siteler</option>
                    <option value="oyunfor">OyunFor</option>
                    <option value="kopazar">Kopazar</option>
                    <option value="bynogame">ByNoGame</option>
                    <option value="yesilyurtgame">Yeşilyurt Game</option>
                    <option value="klasgame">KlasGame</option>
                </select>
            </div>
        </div>

        <!-- Statistics Grid -->
        <div class="stats-mobile grid grid-cols-1 md:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8">
            <div class="glass-effect rounded-xl p-4 sm:p-6 group hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-blue-600 dark:text-blue-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 dark:text-gray-400 text-sm font-medium mb-1">Ortalama Fiyat</p>
                    <p id="avg-price" class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100">--</p>
                </div>
            </div>

            <div class="glass-effect rounded-xl p-4 sm:p-6 group hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-orange-600 dark:text-orange-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6"/>
                        </svg>
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 dark:text-gray-400 text-sm font-medium mb-1">Fiyat Aralığı</p>
                    <p id="price-diff" class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100">--</p>
                </div>
            </div>

            <div class="glass-effect rounded-xl p-4 sm:p-6 group hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-green-100 dark:bg-green-900/30 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-green-600 dark:text-green-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                        </svg>
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 dark:text-gray-400 text-sm font-medium mb-1">Son Güncelleme</p>
                    <p id="last-update" class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100">--</p>
                </div>
            </div>

            <div class="glass-effect rounded-xl p-4 sm:p-6 group hover:scale-105 transition-transform duration-200">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-purple-600 dark:text-purple-400" fill="currentColor" viewBox="0 0 24 24">
                            <path```
 d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                        </svg>
                    </div>
                </div>
                <div>
                    <p class="text-gray-600 dark:text-gray-400 text-sm font-medium mb-1">Aktif Kaynak</p>
                    <p id="active-sources" class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100">--</p>
                </div>
            </div>
        </div>

        <!-- Error Display -->
        <div id="error-display" class="hidden bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0">
                    <svg class="w-5 h-5 text-red-600 dark:text-red-400" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                </div>
                <span id="error-message" class="text-red-800 dark:text-red-200 text-sm font-medium"></span>
            </div>
        </div>

        <!-- Price Table -->
        <div class="glass-effect rounded-2xl overflow-hidden shadow-xl">
            <div class="px-4 py-3 sm:px-6 sm:py-4 border-b border-gray-200 dark:border-slate-700 bg-gradient-to-r from-gold/10 to-gold-dark/10">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                    <h3 class="text-lg sm:text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center mb-2 sm:mb-0">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 mr-2 sm:mr-3 text-gold" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M4,6V18H20V6H4Z"/>
                        </svg>
                        Canlı Fiyat Karşılaştırması
                    </h3>
                    <div class="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400 bg-gold/20 px-3 py-1 rounded-full">
                        1 GB = 10M Gold
                    </div>
                </div>
            </div>

            <!-- Mobile View -->
            <div id="mobile-view" class="block sm:hidden">
                <div id="mobile-price-list" class="p-4 space-y-4">
                    <!-- Mobile cards will be inserted here -->
                </div>
            </div>

            <!-- Desktop View -->
            <div id="desktop-view" class="hidden sm:block overflow-x-auto custom-scrollbar">
                <table class="w-full">
                    <thead class="bg-gray-50 dark:bg-slate-800/50">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                Kaynak
                            </th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                Sunucu
                            </th>
                            <th class="px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                Alış Fiyatı (1 GB)
                            </th>
                            <th class="px-6 py-4 text-right text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                Satış Fiyatı
                            </th>
                            <th class="px-6 py-4 text-center text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                                Durum
                            </th>
                        </tr>
                    </thead>
                    <tbody id="price-table-body" class="divide-y divide-gray-200 dark:divide-slate-700">
                        <!-- Price rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-indicator" class="hidden fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50">
            <div class="glass-effect rounded-2xl p-6 sm:p-8 flex items-center space-x-4 shadow-2xl max-w-sm mx-4">
                <div class="w-6 h-6 sm:w-8 sm:h-8 border-4 border-gold border-t-transparent rounded-full animate-spin"></div>
                <span class="text-gray-900 dark:text-gray-100 font-semibold text-sm sm:text-lg">Fiyatlar güncelleniyor...</span>
            </div>
        </div>
    </main>

    <script>
        // Auto Theme Detection and Management
        function getSystemTheme() {
            return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        let currentTheme = localStorage.getItem('theme') || getSystemTheme();

        function updateTheme() {
            if (currentTheme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            localStorage.setItem('theme', currentTheme);
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            updateTheme();
        }

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (!localStorage.getItem('theme')) {
                currentTheme = event.matches ? 'dark' : 'light';
                updateTheme();
            }
        });

        // Initialize theme
        updateTheme();

        // Utility Functions - NON-BLOCKING
        function showLoading() {
            // Sadece gerçek loading durumunda göster
            // document.getElementById('loading-indicator').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loading-indicator').classList.add('hidden');
        }

        function showError(message) {
            const errorDisplay = document.getElementById('error-display');
            const errorMessage = document.getElementById('error-message');
            errorMessage.textContent = message;
            errorDisplay.classList.remove('hidden');
            setTimeout(() => {
                errorDisplay.classList.add('hidden');
            }, 5000);
        }

        function calculateGBPrice(priceFor1M) {
            return priceFor1M * 100;
        }

        function formatTime(timestamp) {
            if (!timestamp) return '--';
            const date = new Date(timestamp);
            return date.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
        }

        // Data Management
        let allProducts = [];
        let filteredProducts = [];

        function applyFilters() {
            const serverFilter = document.getElementById('server-filter').value;
            const siteFilter = document.getElementById('site-filter').value;

            filteredProducts = allProducts.filter(product => {
                const serverMatch = !serverFilter || product.server.toUpperCase() === serverFilter;
                const siteMatch = !siteFilter || product.siteKey === siteFilter;
                return serverMatch && siteMatch;
            });

            updateFilterInfo();
            renderTable();
        }

        function renderMobileCard(product, isBest) {
            const siteColors = {
                'OyunFor': 'bg-blue-500',
                'Kopazar': 'bg-green-500',
                'ByNoGame': 'bg-purple-500',
                'Yeşilyurt Game': 'bg-orange-500',
                'KlasGame': 'bg-pink-500'
            };

            const serverColors = {
                'ZERO': 'bg-red-500',
                'FELIS': 'bg-orange-500',
                'PANDORA': 'bg-purple-500',
                'AGARTHA': 'bg-blue-500',
                'DRYADS': 'bg-green-500',
                'DESTAN': 'bg-yellow-500',
                'MINARK': 'bg-pink-500',
                'OREADS': 'bg-indigo-500'
            };

            return `
                <div class="mobile-card ${isBest ? 'best-price-glow' : ''}">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-3">
                            <div class="flex items-center justify-center w-8 h-8 rounded-lg ${isBest ? 'bg-gold' : siteColors[product.siteName] || 'bg-gray-500'} text-white text-sm font-bold">
                                ${product.siteName.charAt(0).toUpperCase()}
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900 dark:text-gray-100">${product.siteName}</div>
                                ${isBest ? '<div class="text-xs font-bold text-gold">EN İYİ FİYAT</div>' : ''}
                            </div>
                        </div>
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold text-white ${serverColors[product.server] || 'bg-gray-500'}">
                            ${product.server}
                        </span>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">Alış Fiyatı</div>
                            <div class="text-xl font-bold ${isBest ? 'text-gold' : 'text-gray-900 dark:text-gray-100'}">${product.gbPrice.toFixed(2)} ₺</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">1 GB başına</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">Satış Fiyatı</div>
                            <div class="text-xl font-bold ${product.gbSellPrice ? 'text-gray-900 dark:text-gray-100' : 'text-gray-400'}">
                                ${product.gbSellPrice ? product.gbSellPrice.toFixed(2) + ' ₺' : 'Mevcut Değil'}
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 text-center">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300">
                            <div class="w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"></div>
                            Aktif
                        </span>
                    </div>
                </div>
            `;
        }

        function renderTable() {
            const tbody = document.getElementById('price-table-body');
            const mobileList = document.getElementById('mobile-price-list');

            tbody.innerHTML = '';
            mobileList.innerHTML = '';

            if (filteredProducts.length === 0) {
                const emptyContent = `
                    <div class="flex flex-col items-center space-y-4 py-12">
                        <div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gray-100 dark:bg-slate-800 flex items-center justify-center">
                            <svg class="w-8 h-8 sm:w-10 sm:h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v1M7 8h10"/>
                            </svg>
                        </div>
                        <div class="text-center">
                            <p class="text-lg sm:text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2">Fiyat verisi bulunamadı</p>
                            <p class="text-gray-600 dark:text-gray-400 text-sm sm:text-base">Filtreleri kontrol edin veya sayfayı yenileyin</p>
                        </div>
                    </div>
                `;

                tbody.innerHTML = `<tr><td colspan="5" class="px-6 py-16 text-center">${emptyContent}</td></tr>`;
                mobileList.innerHTML = emptyContent;

                document.getElementById('best-buy-price-display').textContent = 'Veri Yok';
                document.getElementById('best-sell-price-display').textContent = 'Veri Yok';
                return;
            }

            // Sort by GB price (cheapest first)
            filteredProducts.sort((a, b) => a.gbPrice - b.gbPrice);
            const bestPrice = filteredProducts[0].gbPrice;

            filteredProducts.forEach((product, index) => {
                const isBest = index === 0;

                // Mobile card
                mobileList.innerHTML += renderMobileCard(product, isBest);

                // Desktop row
                const row = document.createElement('tr');
                row.className = `table-row ${isBest ? 'best-price-glow' : 'hover:bg-gray-50 dark:hover:bg-slate-800/50'}`;

                const siteColors = {
                    'OyunFor': 'bg-blue-500',
                    'Kopazar': 'bg-green-500',
                    'ByNoGame': 'bg-purple-500',
                    'Yeşilyurt Game': 'bg-orange-500',
                    'KlasGame': 'bg-pink-500'
                };

                const serverColors = {
                    'ZERO': 'bg-red-500',
                    'FELIS': 'bg-orange-500',
                    'PANDORA': 'bg-purple-500',
                    'AGARTHA': 'bg-blue-500',
                    'DRYADS': 'bg-green-500',
                    'DESTAN': 'bg-yellow-500',
                    'MINARK': 'bg-pink-500',
                    'OREADS': 'bg-indigo-500'
                };

                row.innerHTML = `
                    <td class="px-6 py-5">
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center justify-center w-10 h-10 rounded-xl ${isBest ? 'bg-gold' : siteColors[product.siteName] || 'bg-gray-500'} text-white text-sm font-bold">
                                ${product.siteName.charAt(0).toUpperCase()}
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900 dark:text-gray-100 text-lg">${product.siteName}</div>
                                ${isBest ? '<div class="inline-flex items-center px-2 py-1 rounded-md text-xs font-bold bg-gold text-white animate-pulse">EN İYİ FİYAT</div>' : ''}
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-5">
                        <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold text-white ${serverColors[product.server] || 'bg-gray-500'}">
                            ${product.server}
                        </span>
                    </td>
                    <td class="px-6 py-5 text-right">
                        <div class="text-right">
                            <div class="text-3xl font-bold ${isBest ? 'text-gold' : 'text-gray-900 dark:text-gray-100'}">${product.gbPrice.toFixed(2)} ₺</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">1 GB başına (${product.unit})</div>
                        </div>
                    </td>
                    <td class="px-6 py-5 text-right">
                        <div class="text-xl font-semibold ${product.gbSellPrice ? 'text-gray-900 dark:text-gray-100' : 'text-gray-400'}">
                            ${product.gbSellPrice ? product.gbSellPrice.toFixed(2) + ' ₺' : 'Mevcut Değil'}
                        </div>
                    </td>
                    <td class="px-6 py-5 text-center">
                        <span class="inline-flex items-center px-3 py-2 rounded-full text-sm font-semibold bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-700">
                            <div class="w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"></div>
                            Aktif
                        </span>
                    </td>
                `;

                tbody.appendChild(row);
            });

            // Update best price displays
            updateBestDeals();
        }

        // HIZLI CACHE-FIRST FETCH
        async function fetchPrices() {
            try {
                // Hızlı cache fetch - loading gösterme
                const response = await fetch('/api/prices');
                const data = await response.json();

                console.log('Cache response:', data.cacheStatus);

                // Cache'te veri varsa hemen göster
                if (data.data && Object.keys(data.data).length > 0) {
                    updatePriceTable(data.data);
                    updateStatistics(data.data);
                    updateLastUpdateTime(data.lastUpdate);
                    console.log('Data loaded from cache successfully');
                } else {
                    // Cache boşsa empty state göster
                    setEmptyState();
                    console.log('Cache is empty, showing empty state');

                    // Background update trigger et
                    triggerBackgroundUpdate();
                }

            } catch (error) {
                console.error('Error fetching prices:', error);
                setEmptyState();
                showError('Veriler alınırken hata oluştu, tekrar denenecek...');

                // Hata durumunda background update trigger et
                setTimeout(triggerBackgroundUpdate, 2000);
            }
        }

        async function triggerBackgroundUpdate() {
            try {
                console.log('Triggering background update...');
                await fetch('/api/prices/update', { method: 'POST' });
                console.log('Background update triggered');

                // 5 saniye sonra cache'i tekrar kontrol et
                setTimeout(fetchPrices, 5000);
            } catch (error) {
                console.error('Failed to trigger background update:', error);
                // 10 saniye sonra tekrar dene
                setTimeout(triggerBackgroundUpdate, 10000);
            }
        }

        function setEmptyState() {
            // Boş state için hızlı UI update
            document.getElementById('best-buy-price-display').textContent = 'Yükleniyor...';
            document.getElementById('best-buy-site-name').textContent = 'Veriler hazırlanıyor...';
            document.getElementById('best-sell-price-display').textContent = 'Yükleniyor...';
            document.getElementById('best-sell-site-name').textContent = 'Veriler hazırlanıyor...';

            document.getElementById('avg-price').textContent = '--';
            document.getElementById('price-diff').textContent = '--';
            document.getElementById('active-sources').textContent = '0';
            document.getElementById('last-update').textContent = '--';

            // Tablo boş state
            const tbody = document.getElementById('price-table-body');
            const mobileList = document.getElementById('mobile-price-list');

            const emptyContent = `
                <div class="flex flex-col items-center space-y-4 py-12">
                    <div class="w-16 h-16 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center animate-pulse">
                        <svg class="w-8 h-8 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                    </div>
                    <div class="text-center">
                        <p class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2">Fiyatlar hazırlanıyor</p>
                        <p class="text-gray-600 dark:text-gray-400 text-sm">Lütfen birkaç saniye bekleyiniz...</p>
                    </div>
                </div>
            `;

            tbody.innerHTML = `<tr><td colspan="5" class="px-6 py-16 text-center">${emptyContent}</td></tr>`;
            mobileList.innerHTML = emptyContent;
        }

        function updatePriceTable(siteData) {
            console.log('Fiyat tablosu güncelleniyor:', siteData);

            allProducts = [];
            let activeSources = 0;

            Object.values(siteData).forEach(site => {
                console.log(`Site işleniyor: ${site.name}, durum: ${site.status}, ürünler:`, site.products);

                if (site.status === 'success' && site.products && Array.isArray(site.products)) {
                    activeSources++;
                    site.products.forEach(product => {
                        if (product.buyPrice && product.server) {
                            allProducts.push({
                                ...product,
                                siteName: site.name,
                                siteKey: site.site,
                                gbPrice: calculateGBPrice(product.buyPrice),
                                gbSellPrice: product.sellPrice ? calculateGBPrice(product.sellPrice) : null
                            });
                        }
                    });
                }
            });

            document.getElementById('active-sources').textContent = activeSources;

            console.log('Tüm ürünler:', allProducts);

            applyFilters();
        }

        function updateStatistics(siteData) {
            const allPrices = [];

            Object.values(siteData).forEach(site => {
                if (site.status === 'success' && site.products) {
                    site.products.forEach(product => {
                        if (product.buyPrice) {
                            allPrices.push(calculateGBPrice(product.buyPrice));
                        }
                    });
                }
            });

            if (allPrices.length > 0) {
                const avgPrice = allPrices.reduce((a, b) => a + b, 0) / allPrices.length;
                const maxPrice = Math.max(...allPrices);
                const minPrice = Math.min(...allPrices);

                document.getElementById('avg-price').textContent = `${avgPrice.toFixed(2)} ₺`;
                document.getElementById('price-diff').textContent = `${(maxPrice - minPrice).toFixed(2)} ₺`;
            } else {
                document.getElementById('avg-price').textContent = '--';
                document.getElementById('price-diff').textContent = '--';
                document.getElementById('active-sources').textContent = '0';
            }
        }

        function updateLastUpdateTime(timestamp) {
            document.getElementById('last-update').textContent = formatTime(timestamp);
        }

        function setLoadingState() {
            // Unified loading state for both cards
            document.getElementById('best-buy-price-display').textContent = 'Yükleniyor...';
            document.getElementById('best-buy-site-name').textContent = 'Veriler getiriliyor...';
            document.getElementById('best-buy-server-name').textContent = '--';
            document.getElementById('best-buy-site-icon').textContent = '?';

            document.getElementById('best-sell-price-display').textContent = 'Yükleniyor...';
            document.getElementById('best-sell-site-name').textContent = 'Veriler getiriliyor...';
            document.getElementById('best-sell-server-name').textContent = '--';
            document.getElementById('best-sell-site-icon').textContent = '?';
        }

        function updateBestDeals() {
            if (filteredProducts.length === 0) {
                // Unified empty state for both cards
                document.getElementById('best-buy-price-display').textContent = 'Veri Yok';
                document.getElementById('best-buy-site-name').textContent = 'Henüz veri alınamadı';
                document.getElementById('best-buy-server-name').textContent = '--';
                document.getElementById('best-buy-site-icon').textContent = '?';

                document.getElementById('best-sell-price-display').textContent = 'Veri Yok';
                document.getElementById('best-sell-site-name').textContent = 'Henüz veri alınamadı';
                document.getElementById('best-sell-server-name').textContent = '--';
                document.getElementById('best-sell-site-icon').textContent = '?';
                return;
            }

            // Find best buy price (cheapest)
            const sortedByBuyPrice = [...filteredProducts].sort((a, b) => a.gbPrice - b.gbPrice);
            const bestBuyProduct = sortedByBuyPrice[0];

            // Find best sell price (highest) - only among products that have sell prices
            const productsWithSellPrice = filteredProducts.filter(p => p.gbSellPrice !== null);
            let bestSellProduct = null;
            if (productsWithSellPrice.length > 0) {
                const sortedBySellPrice = productsWithSellPrice.sort((a, b) => b.gbSellPrice - a.gbSellPrice);
                bestSellProduct = sortedBySellPrice[0];
            }

            // Site colors mapping
            const siteColors = {
                'OyunFor': { bg: 'bg-blue-500', icon: 'O' },
                'Kopazar': { bg: 'bg-green-500', icon: 'K' },
                'ByNoGame': { bg: 'bg-purple-500', icon: 'B' },
                'Yeşilyurt Game': { bg: 'bg-orange-500', icon: 'Y' },
                'KlasGame': { bg: 'bg-pink-500', icon: 'G' }
            };

            // Update best buy display
            if (bestBuyProduct) {
                document.getElementById('best-buy-price-display').textContent = `${bestBuyProduct.gbPrice.toFixed(2)} ₺`;
                document.getElementById('best-buy-site-name').textContent = bestBuyProduct.siteName;
                document.getElementById('best-buy-server-name').textContent = `${bestBuyProduct.server} Sunucusu`;

                const siteColor = siteColors[bestBuyProduct.siteName] || { bg: 'bg-gray-500', icon: '?' };
                const buyIcon = document.getElementById('best-buy-site-icon');
                buyIcon.className = `w-10 h-10 rounded-xl ${siteColor.bg} text-white flex items-center justify-center font-bold text-lg`;
                buyIcon.textContent = siteColor.icon;
            }

            // Update best sell display
            if (bestSellProduct) {
                document.getElementById('best-sell-price-display').textContent = `${bestSellProduct.gbSellPrice.toFixed(2)} ₺`;
                document.getElementById('best-sell-site-name').textContent = bestSellProduct.siteName;
                document.getElementById('best-sell-server-name').textContent = `${bestSellProduct.server} Sunucusu`;

                const siteColor = siteColors[bestSellProduct.siteName] || { bg: 'bg-gray-500', icon: '?' };
                const sellIcon = document.getElementById('best-sell-site-icon');
                sellIcon.className = `w-10 h-10 rounded-xl ${siteColor.bg} text-white flex items-center justify-center font-bold text-lg`;
                sellIcon.textContent = siteColor.icon;
            } else {
                document.getElementById('best-sell-price-display').textContent = 'Mevcut Değil';
                document.getElementById('best-sell-site-name').textContent = 'Satış fiyatı bulunamadı';
                document.getElementById('best-sell-server-name').textContent = 'Tüm siteler kontrol edildi';
                document.getElementById('best-sell-site-icon').textContent = '−';
            }
        }

        // Quick Server Selection Functions
        function selectServer(serverCode) {
            // Update dropdown value
            document.getElementById('server-filter').value = serverCode;

            // Update button states
            document.querySelectorAll('.server-btn').forEach(btn => {
                btn.classList.remove('server-btn-active');
            });

            if (serverCode === '') {
                document.getElementById('server-btn-all').classList.add('server-btn-active');
                document.getElementById('filter-text').textContent = 'Tüm sunucular gösteriliyor';
            } else {
                document.getElementById(`server-btn-${serverCode}`).classList.add('server-btn-active');
                document.getElementById('filter-text').textContent = `${serverCode} sunucusu gösteriliyor`;
            }

            // Apply filters
            applyFilters();
        }

        function setupServerButtons() {
            // All servers button
            document.getElementById('server-btn-all').addEventListener('click', () => {
                selectServer('');
            });

            // Individual server buttons
            const servers = ['ZERO', 'FELIS', 'PANDORA', 'AGARTHA', 'DRYADS', 'DESTAN', 'MINARK', 'OREADS'];
            servers.forEach(server => {
                const button = document.getElementById(`server-btn-${server}`);
                if (button) {
                    button.addEventListener('click', () => {
                        selectServer(server);
                    });
                }
            });
        }

        function updateFilterInfo() {
            const serverFilter = document.getElementById('server-filter').value;
            const siteFilter = document.getElementById('site-filter').value;

            let filterText = '';

            if (serverFilter && siteFilter) {
                filterText = `${serverFilter} sunucusu, ${getSiteName(siteFilter)} sitesi gösteriliyor`;
            } else if (serverFilter) {
                filterText = `${serverFilter} sunucusu gösteriliyor`;
            } else if (siteFilter) {
                filterText = `${getSiteName(siteFilter)} sitesi gösteriliyor`;
            } else {
                filterText = 'Tüm sunucular gösteriliyor';
            }

            document.getElementById('filter-text').textContent = filterText;
        }

        function getSiteName(siteKey) {
            const siteNames = {
                'oyunfor': 'OyunFor',
                'kopazar': 'Kopazar',
                'bynogame': 'ByNoGame',
                'yesilyurtgame': 'Yeşilyurt Game',
                'klasgame': 'KlasGame'
            };
            return siteNames[siteKey] || siteKey;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Hemen cache'ten veri çek
            fetchPrices();
            setupServerButtons();

            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

            // Sync dropdown with buttons when changed manually
            document.getElementById('server-filter').addEventListener('change', () => {
                const selectedServer = document.getElementById('server-filter').value;
                selectServer(selectedServer);
            });

            document.getElementById('site-filter').addEventListener('change', applyFilters);

            // Auto refresh every 30 seconds - sadece cache'i kontrol et
            setInterval(fetchPrices, 30 * 1000);
        });
    </script>
</body>
</html>